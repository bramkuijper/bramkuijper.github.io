<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Individual-based simulations and drift | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Individual-based simulations and drift | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Individual-based simulations and drift | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Bram Kuijper" />


<meta name="date" content="2022-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="an-evolutionary-model-of-the-hawk-dove-game.html"/>
<link rel="next" href="hawk-dove-games-with-relatives.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Practical EBE handout</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Practicals on evolutionary models using R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#opening-the-r-environment"><i class="fa fa-check"></i><b>1.2</b> Opening the R environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html"><i class="fa fa-check"></i><b>2</b> A brief R programming crash course</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#naming-variables"><i class="fa fa-check"></i><b>2.1.1</b> Naming variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#changing-the-value-stored-by-variables"><i class="fa fa-check"></i><b>2.1.2</b> Changing the value stored by variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#vectors-and-element-selection"><i class="fa fa-check"></i><b>2.2</b> Vectors and element selection</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercises"><i class="fa fa-check"></i><b>2.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#information-about-your-vector"><i class="fa fa-check"></i><b>2.3</b> Information about your vector</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercise"><i class="fa fa-check"></i><b>2.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#sequences"><i class="fa fa-check"></i><b>2.4</b> Sequences</a></li>
<li class="chapter" data-level="2.5" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#the-important-bit-for-loops"><i class="fa fa-check"></i><b>2.5</b> The important bit: <code>for</code> loops</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#dissecting-the-for-loop"><i class="fa fa-check"></i><b>2.5.1</b> Dissecting the for loop</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#another-example"><i class="fa fa-check"></i><b>2.5.2</b> Another example</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercises-1"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html"><i class="fa fa-check"></i><b>3</b> An evolutionary model of the hawk-dove game</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#payoff-matrices"><i class="fa fa-check"></i><b>3.1</b> Payoff matrices</a></li>
<li class="chapter" data-level="3.2" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-1"><i class="fa fa-check"></i><b>3.2</b> Exercise</a></li>
<li class="chapter" data-level="3.3" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#a-haploid-population-genetical-model-of-the-hawk-dove-game"><i class="fa fa-check"></i><b>3.3</b> A haploid population genetical model of the Hawk-Dove game</a></li>
<li class="chapter" data-level="3.4" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#lots-of-crazy-assumptions"><i class="fa fa-check"></i><b>3.4</b> Lots of crazy assumptions</a></li>
<li class="chapter" data-level="3.5" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#allele-frequencies"><i class="fa fa-check"></i><b>3.5</b> Allele frequencies</a></li>
<li class="chapter" data-level="3.6" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#life-cycle"><i class="fa fa-check"></i><b>3.6</b> Life cycle</a></li>
<li class="chapter" data-level="3.7" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#fitness"><i class="fa fa-check"></i><b>3.7</b> Fitness</a></li>
<li class="chapter" data-level="3.8" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-2"><i class="fa fa-check"></i><b>3.8</b> Exercise</a></li>
<li class="chapter" data-level="3.9" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#evolutionary-dynamics"><i class="fa fa-check"></i><b>3.9</b> Evolutionary dynamics</a></li>
<li class="chapter" data-level="3.10" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#relation-to-delta-p-in-lecture-slides-this-section-is-optional"><i class="fa fa-check"></i><b>3.10</b> Relation to <span class="math inline">\(\Delta p\)</span> in lecture slides (this section is optional)</a></li>
<li class="chapter" data-level="3.11" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-implementing-your-first-evolutionary-algorithm-in-r"><i class="fa fa-check"></i><b>3.11</b> Exercise: implementing your first evolutionary algorithm in R</a></li>
<li class="chapter" data-level="3.12" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-3"><i class="fa fa-check"></i><b>3.12</b> Exercise</a></li>
<li class="chapter" data-level="3.13" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-4"><i class="fa fa-check"></i><b>3.13</b> Exercise</a></li>
<li class="chapter" data-level="3.14" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-5"><i class="fa fa-check"></i><b>3.14</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html"><i class="fa fa-check"></i><b>4</b> Individual-based simulations and drift</a>
<ul>
<li class="chapter" data-level="4.1" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#before-you-start-this-practical"><i class="fa fa-check"></i><b>4.1</b> Before you start this practical</a></li>
<li class="chapter" data-level="4.2" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#installing-the-driftsim-package"><i class="fa fa-check"></i><b>4.2</b> Installing the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.3" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#individual-based-models"><i class="fa fa-check"></i><b>4.3</b> Individual-based models</a></li>
<li class="chapter" data-level="4.4" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#life-cycle-1"><i class="fa fa-check"></i><b>4.4</b> Life cycle</a></li>
<li class="chapter" data-level="4.5" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-limiting-assumptions"><i class="fa fa-check"></i><b>4.5</b> Exercise: limiting assumptions</a></li>
<li class="chapter" data-level="4.6" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#running-the-driftsim-package"><i class="fa fa-check"></i><b>4.6</b> Running the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.7" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-plotting-the-output-from-the-driftsim-package"><i class="fa fa-check"></i><b>4.7</b> Exercise: plotting the output from the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.8" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-change-the-initial-frequency-of-hawks"><i class="fa fa-check"></i><b>4.8</b> Exercise: change the initial frequency of hawks</a></li>
<li class="chapter" data-level="4.9" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-increase-the-population-size"><i class="fa fa-check"></i><b>4.9</b> Exercise: increase the population size</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html"><i class="fa fa-check"></i><b>5</b> Hawk Dove games with relatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-running-the-model"><i class="fa fa-check"></i><b>5.1</b> Exercise: running the model</a></li>
<li class="chapter" data-level="5.2" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#interactions-among-relatives"><i class="fa fa-check"></i><b>5.2</b> Interactions among relatives</a></li>
<li class="chapter" data-level="5.3" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#hamiltons-rule-in-a-hawk-dove-game"><i class="fa fa-check"></i><b>5.3</b> Hamilton’s rule in a Hawk Dove game?</a></li>
<li class="chapter" data-level="5.4" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-the-downfall-of-hamiltons-rule"><i class="fa fa-check"></i><b>5.4</b> Exercise: the downfall of Hamilton’s rule</a></li>
<li class="chapter" data-level="5.5" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#evolution-of-aggression-when-relatives-interact-in-r"><i class="fa fa-check"></i><b>5.5</b> Evolution of aggression when relatives interact in R</a></li>
<li class="chapter" data-level="5.6" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-explaining-these-expressions"><i class="fa fa-check"></i><b>5.6</b> Exercise: explaining these expressions?</a></li>
<li class="chapter" data-level="5.7" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-implementing-it-in-the-numerical-model"><i class="fa fa-check"></i><b>5.7</b> Exercise: implementing it in the numerical model</a></li>
<li class="chapter" data-level="5.8" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-varying-the-values-of-r"><i class="fa fa-check"></i><b>5.8</b> Exercise: varying the values of <span class="math inline">\(r\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html"><i class="fa fa-check"></i><b>6</b> Spatially explicit models of the Hawk Dove game</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-6"><i class="fa fa-check"></i><b>6.1</b> Exercise</a></li>
<li class="chapter" data-level="6.2" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#investigating-how-dispersal-affects-aggression-adding-space-to-the-hawk-dove-game"><i class="fa fa-check"></i><b>6.2</b> Investigating how dispersal affects aggression: adding space to the Hawk Dove game</a></li>
<li class="chapter" data-level="6.3" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-7"><i class="fa fa-check"></i><b>6.3</b> Exercise</a></li>
<li class="chapter" data-level="6.4" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#a-spatial-model-of-the-hawk-dove-game"><i class="fa fa-check"></i><b>6.4</b> A spatial model of the hawk dove game</a></li>
<li class="chapter" data-level="6.5" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-8"><i class="fa fa-check"></i><b>6.5</b> Exercise</a></li>
<li class="chapter" data-level="6.6" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-9"><i class="fa fa-check"></i><b>6.6</b> Exercise</a></li>
<li class="chapter" data-level="6.7" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-10"><i class="fa fa-check"></i><b>6.7</b> Exercise</a></li>
<li class="chapter" data-level="6.8" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-11"><i class="fa fa-check"></i><b>6.8</b> Exercise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="individual-based-simulations-and-drift" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Individual-based simulations and drift<a href="individual-based-simulations-and-drift.html#individual-based-simulations-and-drift" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Previously, the model of the Hawk-Dove game that we have used was <strong>deterministic</strong>, where multiple runs for the same values of the parameters <span class="math inline">\(v\)</span> and <span class="math inline">\(c\)</span> always result in the same outcome.</p>
<p>In reality, however, evolution does not work like that, as quite a number of biological processes are the result of <strong>chance</strong>. To give some examples: chance plays a big role in determining whether a mutation occurs or not, whether or not you happen to encounter a hawk rather than a dove, which gamete actually contributes to the next generation or which offspring manages to survive in order to reproduce.</p>
<p>Introducing chance in models of evolution makes these models <strong>stochastic</strong>, meaning that any two runs of the same model (with the same values of the parameters) does not necessarily result in the same outcome. Stochasticity in evolution introduces a phenomenon called ‘genetic drift’ which we will explore in this practical. Genetic drift can – particularly in small populations – dramatically affect the course of evolution!</p>
<div id="before-you-start-this-practical" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Before you start this practical<a href="individual-based-simulations-and-drift.html#before-you-start-this-practical" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, please be reminded to use one of the <a href="https://rstudio01.cles.ex.ac.uk">Rstudio servers</a> rather than your local installation of R. This is because we will be using some custom-built R packages, which themselves require extensions like <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a> that can be a bit of a pain to install on some computers. Luckily, this should all have been done for you on the Rstudio server.</p>
<p>Next, when logged in on the Rstudio server, please use R version <code>4.1.1.</code></p>
<p>And finally, it may be worthwhile to remove variables from our previous session, which we do by typing in the following</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="individual-based-simulations-and-drift.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean all R variables</span></span>
<span id="cb18-2"><a href="individual-based-simulations-and-drift.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="installing-the-driftsim-package" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Installing the <code>driftSim</code> package<a href="individual-based-simulations-and-drift.html#installing-the-driftsim-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, let’s get started. In this part of the practical, we will explore a model that includes stochasticity. Such a model is provided in the R package <code>driftSim</code>. To install this package, do the following:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="individual-based-simulations-and-drift.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;devtools&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb19-2"><a href="individual-based-simulations-and-drift.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="individual-based-simulations-and-drift.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;devtools&quot;</span>) </span>
<span id="cb19-4"><a href="individual-based-simulations-and-drift.html#cb19-4" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;bramkuijper/driftSim&quot;</span>)</span></code></pre></div>
<p>If you get a message like <code>Skipping install of 'driftSim' from a github remote, the SHA1 (27e9c52c) has not changed since last install. Use</code>force = TRUE<code>to force installation</code>, R is simply telling you the package has already been installed. Consequently, you can just move on to the next step.</p>
<p>Then we can load the library using:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="individual-based-simulations-and-drift.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;driftSim&quot;</span>)</span></code></pre></div>
</div>
<div id="individual-based-models" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Individual-based models<a href="individual-based-simulations-and-drift.html#individual-based-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This package contains what we call an <em>individual-based simulation</em>, which is nothing more than a computer program that models individuals and their actions (e.g., surviving, fighting, reproducing). By contrast, in the previous set of exercises, we did not focus on individuals too much, but rather on an <em>analytical model</em> which tracked the population-wide frequency <span class="math inline">\(p_{t}\)</span> of hawks. Indeed, keeping track of a single population-wide frequency <span class="math inline">\(p_{t}\)</span> is a lot simpler than keeping track of thousands or even millions of individuals. However, such simplicity also comes also at a price, which will be the focus of this chapter.</p>
<p>While the simulation package <code>driftSim</code> runs within R, under the hood it is coded in the low-level programming language <a href="https://cplusplus.com/doc/tutorial/">C++</a>. This is because large simulations tend to be very slow in R, but run much faster in C++. Below you see a little snippet from this package, reflecting the properties of single individual:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb21-1"><a href="individual-based-simulations-and-drift.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Individual <span class="op">{</span></span>
<span id="cb21-2"><a href="individual-based-simulations-and-drift.html#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">bool</span> is_hawk<span class="op">;</span> <span class="co">// TRUE/FALSE individual is hawk or dove</span></span>
<span id="cb21-3"><a href="individual-based-simulations-and-drift.html#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> payoff<span class="op">;</span> <span class="co">// the value of the payoff</span></span>
<span id="cb21-4"><a href="individual-based-simulations-and-drift.html#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">double</span> prob_hawk<span class="op">;</span> <span class="co">// the probability that this individual develops as a hawk in early life (only used when strategies are mixed)</span></span>
<span id="cb21-5"><a href="individual-based-simulations-and-drift.html#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<p>The program then simulates a <strong>finite</strong> population of <span class="math inline">\(N\)</span> of these individuals. You might remember that the analytical model in the previous chapter assumed infinitely many individuals, so while the individual-based model is an absolute loser when it comes to speed, it is already a winner when it comes to increased realism!</p>
</div>
<div id="life-cycle-1" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Life cycle<a href="individual-based-simulations-and-drift.html#life-cycle-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the start of each generation, each individual interacts with a randomly chosen other individual and either attacks (hawk) or displays (dove). It gets its payoffs based on the same payoff matrix as we used in the deterministic model in the previous chapter. Subsequently, we then produce <span class="math inline">\(N\)</span> newborn offspring from this population. Parents of each of these offspring are sampled from the previous generation, with individuals who have a larger payoff being more likely to be selected than individuals which have a lower payoff.</p>
</div>
<div id="exercise-limiting-assumptions" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercise: limiting assumptions<a href="individual-based-simulations-and-drift.html#exercise-limiting-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Individual-based simulations are often used to relax many of the limiting assumptions present in deterministic models, as writing computer code allows for much more flexibility than when using mathematical formulas. We have already seen how individual-based simulations have relaxed one assumption of the popoulation genetics mode, namely the fact that population sizes can now be finite, rather than infinite.</p>
<p>Can you list three other limiting assumptions from the deterministic population genetics model that you would like to relax? For each assumption, can you think how relaxing the assumption could potentially affect results? (It is often much easier to spell out what is wrong with a model than to spell out how addressing it will change outcomes!)</p>
</div>
<div id="running-the-driftsim-package" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Running the <code>driftSim</code> package<a href="individual-based-simulations-and-drift.html#running-the-driftsim-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>driftSim</code> package contains a single function, called <code>runSimulation()</code>. Before running this function, please inspect the documentation by typing <code>?runSimulation()</code> in your R console, after which a help page should show up.</p>
<p>Let us start with a simple example run with a population size of <span class="math inline">\(N=10\)</span>, <span class="math inline">\(v=1.0\)</span>, <span class="math inline">\(c=2.0\)</span> and a bunch of different parameters. Most are not so important, except that the initial frequency <span class="math inline">\(p_{t=0}\)</span> of hawks which is set at <span class="math inline">\(p_{t=0} = 0.25\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="individual-based-simulations-and-drift.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runSimulation</span>(<span class="at">N=</span><span class="dv">10</span>,<span class="at">v=</span><span class="fl">1.0</span>,<span class="at">c=</span><span class="fl">2.0</span>,<span class="at">is_pure=</span>T,<span class="at">mu=</span><span class="dv">0</span>,<span class="at">max_time=</span><span class="dv">10</span>,<span class="at">pHawk_init=</span><span class="fl">0.25</span>,<span class="at">output_nth_generation=</span><span class="dv">1</span>,<span class="at">sd_pHawkMixed=</span><span class="dv">0</span>)</span>
<span id="cb22-2"><a href="individual-based-simulations-and-drift.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="do">##    generation freq_Hawk mean_pHawkMixed sd_pHawkMixed</span></span>
<span id="cb22-3"><a href="individual-based-simulations-and-drift.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 1           1       0.1               0             0</span></span>
<span id="cb22-4"><a href="individual-based-simulations-and-drift.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 2           2       0.2               0             0</span></span>
<span id="cb22-5"><a href="individual-based-simulations-and-drift.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 3           3       0.3               0             0</span></span>
<span id="cb22-6"><a href="individual-based-simulations-and-drift.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 4           4       0.4               0             0</span></span>
<span id="cb22-7"><a href="individual-based-simulations-and-drift.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 5           5       0.3               0             0</span></span>
<span id="cb22-8"><a href="individual-based-simulations-and-drift.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 6           6       0.3               0             0</span></span>
<span id="cb22-9"><a href="individual-based-simulations-and-drift.html#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 7           7       0.4               0             0</span></span>
<span id="cb22-10"><a href="individual-based-simulations-and-drift.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 8           8       0.3               0             0</span></span>
<span id="cb22-11"><a href="individual-based-simulations-and-drift.html#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 9           9       0.5               0             0</span></span>
<span id="cb22-12"><a href="individual-based-simulations-and-drift.html#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 10         10       0.7               0             0</span></span></code></pre></div>
<p>In this way, however, we cannot use the data from the <code>runSimulation()</code> function, as it will simply be printed out to the console, but it is not stored anywhere. To make sure that the resulting data will be contained in a <code>data.frame</code>, we assign the return values from the <code>runSimulation()</code> function to a variable, like this:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="individual-based-simulations-and-drift.html#cb23-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">runSimulation</span>(<span class="at">N=</span><span class="dv">10</span>,<span class="at">v=</span><span class="fl">1.0</span>,<span class="at">c=</span><span class="fl">2.0</span>,<span class="at">is_pure=</span>T,<span class="at">mu=</span><span class="dv">0</span>,<span class="at">max_time=</span><span class="dv">10</span>,<span class="at">pHawk_init=</span><span class="fl">0.25</span>,<span class="at">output_nth_generation=</span><span class="dv">1</span>,<span class="at">sd_pHawkMixed=</span><span class="dv">0</span>)</span></code></pre></div>
<p>The <code>my.data</code> variable points to a <code>data.frame</code> with the following columns:
1. <code>generation</code>: generation time point
2. <code>freq_Hawk</code>: the frequency of hawks in the population, the variable of interest
3. <code>mean_pHawkMixed</code>: in case hawks and doves are the result of a mixed strategy, this is the (evolving) probability that any individual will develop as hawk at the start of its life. This is 0 in case <code>is_pure=T</code>, when we consider pure strategies of hawks and Doves
4. <code>sd_pHawkMixed</code>: variation among individuals in their ability to develop as hawks (only nonzero when <code>is_pure=F</code>)</p>
</div>
<div id="exercise-plotting-the-output-from-the-driftsim-package" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Exercise: plotting the output from the <code>driftSim</code> package<a href="individual-based-simulations-and-drift.html#exercise-plotting-the-output-from-the-driftsim-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Make a plot where plot <code>generation</code> on the <span class="math inline">\(x\)</span>-axis and <code>freq_Hawk</code> on the <span class="math inline">\(y\)</span>-axis. Re-run your simulation at least 10 times. What happens (typically) with the hawk allele?</p>
</div>
<div id="exercise-change-the-initial-frequency-of-hawks" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Exercise: change the initial frequency of hawks<a href="individual-based-simulations-and-drift.html#exercise-change-the-initial-frequency-of-hawks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, change the initial frequency of hawks by changing the value of <code>pHawk_init</code> to <code>pHawk_init=0.75</code>. Run the simulation for a long time, for example <code>max_time=500</code>. What happens now with the frequency of hawks? What does that tell you about the differences between the analytical model and the current one? Do we still reach the predicted equilibrium frequency of hawks <span class="math inline">\(\hat{p} = v/c\)</span>?</p>
</div>
<div id="exercise-increase-the-population-size" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> Exercise: increase the population size<a href="individual-based-simulations-and-drift.html#exercise-increase-the-population-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, try the same with a population size of <span class="math inline">\(N=500\)</span>. What happens now?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="an-evolutionary-model-of-the-hawk-dove-game.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hawk-dove-games-with-relatives.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bramkuijper/03-drift.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
