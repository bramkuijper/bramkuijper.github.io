<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Hawk Dove games with relatives | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Hawk Dove games with relatives | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Hawk Dove games with relatives | Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Bram Kuijper" />


<meta name="date" content="2022-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="individual-based-simulations-and-drift.html"/>
<link rel="next" href="spatially-explicit-models-of-the-hawk-dove-game.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Practical EBE handout</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#opening-the-r-environment"><i class="fa fa-check"></i><b>1.2</b> Opening the R environment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html"><i class="fa fa-check"></i><b>2</b> A brief R programming crash course</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#naming-variables"><i class="fa fa-check"></i><b>2.1.1</b> Naming variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#changing-the-value-stored-by-variables"><i class="fa fa-check"></i><b>2.1.2</b> Changing the value stored by variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#vectors-and-element-selection"><i class="fa fa-check"></i><b>2.2</b> Vectors and element selection</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercises"><i class="fa fa-check"></i><b>2.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#information-about-your-vector"><i class="fa fa-check"></i><b>2.3</b> Information about your vector</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercise"><i class="fa fa-check"></i><b>2.3.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#sequences"><i class="fa fa-check"></i><b>2.4</b> Sequences</a></li>
<li class="chapter" data-level="2.5" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#the-important-bit-for-loops"><i class="fa fa-check"></i><b>2.5</b> The important bit: <code>for</code> loops</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#dissecting-the-for-loop"><i class="fa fa-check"></i><b>2.5.1</b> Dissecting the for loop</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#another-example"><i class="fa fa-check"></i><b>2.5.2</b> Another example</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-brief-r-programming-crash-course.html"><a href="a-brief-r-programming-crash-course.html#exercises-1"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html"><i class="fa fa-check"></i><b>3</b> An evolutionary model of the hawk-dove game</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#payoff-matrices"><i class="fa fa-check"></i><b>3.1</b> Payoff matrices</a></li>
<li class="chapter" data-level="3.2" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-1"><i class="fa fa-check"></i><b>3.2</b> Exercise</a></li>
<li class="chapter" data-level="3.3" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#a-haploid-population-genetical-model-of-the-hawk-dove-game"><i class="fa fa-check"></i><b>3.3</b> A haploid population genetical model of the Hawk-Dove game</a></li>
<li class="chapter" data-level="3.4" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#lots-of-crazy-assumptions"><i class="fa fa-check"></i><b>3.4</b> Lots of crazy assumptions</a></li>
<li class="chapter" data-level="3.5" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#allele-frequencies"><i class="fa fa-check"></i><b>3.5</b> Allele frequencies</a></li>
<li class="chapter" data-level="3.6" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#life-cycle"><i class="fa fa-check"></i><b>3.6</b> Life cycle</a></li>
<li class="chapter" data-level="3.7" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#fitness"><i class="fa fa-check"></i><b>3.7</b> Fitness</a></li>
<li class="chapter" data-level="3.8" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-2"><i class="fa fa-check"></i><b>3.8</b> Exercise</a></li>
<li class="chapter" data-level="3.9" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#evolutionary-dynamics"><i class="fa fa-check"></i><b>3.9</b> Evolutionary dynamics</a></li>
<li class="chapter" data-level="3.10" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#relation-to-delta-p-in-lecture-slides-this-section-is-optional"><i class="fa fa-check"></i><b>3.10</b> Relation to <span class="math inline">\(\Delta p\)</span> in lecture slides (this section is optional)</a></li>
<li class="chapter" data-level="3.11" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-implementing-your-first-evolutionary-algorithm-in-r"><i class="fa fa-check"></i><b>3.11</b> Exercise: implementing your first evolutionary algorithm in R</a></li>
<li class="chapter" data-level="3.12" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-3"><i class="fa fa-check"></i><b>3.12</b> Exercise</a></li>
<li class="chapter" data-level="3.13" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-4"><i class="fa fa-check"></i><b>3.13</b> Exercise</a></li>
<li class="chapter" data-level="3.14" data-path="an-evolutionary-model-of-the-hawk-dove-game.html"><a href="an-evolutionary-model-of-the-hawk-dove-game.html#exercise-5"><i class="fa fa-check"></i><b>3.14</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html"><i class="fa fa-check"></i><b>4</b> Individual-based simulations and drift</a>
<ul>
<li class="chapter" data-level="4.1" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#before-you-start-this-practical"><i class="fa fa-check"></i><b>4.1</b> Before you start this practical</a></li>
<li class="chapter" data-level="4.2" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#installing-the-driftsim-package"><i class="fa fa-check"></i><b>4.2</b> Installing the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.3" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#individual-based-models"><i class="fa fa-check"></i><b>4.3</b> Individual-based models</a></li>
<li class="chapter" data-level="4.4" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#life-cycle-1"><i class="fa fa-check"></i><b>4.4</b> Life cycle</a></li>
<li class="chapter" data-level="4.5" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-limiting-assumptions"><i class="fa fa-check"></i><b>4.5</b> Exercise: limiting assumptions</a></li>
<li class="chapter" data-level="4.6" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#running-the-driftsim-package"><i class="fa fa-check"></i><b>4.6</b> Running the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.7" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-plotting-the-output-from-the-driftsim-package"><i class="fa fa-check"></i><b>4.7</b> Exercise: plotting the output from the <code>driftSim</code> package</a></li>
<li class="chapter" data-level="4.8" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-change-the-initial-frequency-of-hawks"><i class="fa fa-check"></i><b>4.8</b> Exercise: change the initial frequency of hawks</a></li>
<li class="chapter" data-level="4.9" data-path="individual-based-simulations-and-drift.html"><a href="individual-based-simulations-and-drift.html#exercise-increase-the-population-size"><i class="fa fa-check"></i><b>4.9</b> Exercise: increase the population size</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html"><i class="fa fa-check"></i><b>5</b> Hawk Dove games with relatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-running-the-model"><i class="fa fa-check"></i><b>5.1</b> Exercise: running the model</a></li>
<li class="chapter" data-level="5.2" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#interactions-among-relatives"><i class="fa fa-check"></i><b>5.2</b> Interactions among relatives</a></li>
<li class="chapter" data-level="5.3" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#hamiltons-rule-in-a-hawk-dove-game"><i class="fa fa-check"></i><b>5.3</b> Hamilton’s rule in a Hawk Dove game?</a></li>
<li class="chapter" data-level="5.4" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-the-downfall-of-hamiltons-rule"><i class="fa fa-check"></i><b>5.4</b> Exercise: the downfall of Hamilton’s rule</a></li>
<li class="chapter" data-level="5.5" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#evolution-of-aggression-when-relatives-interact-in-r"><i class="fa fa-check"></i><b>5.5</b> Evolution of aggression when relatives interact in R</a></li>
<li class="chapter" data-level="5.6" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-explaining-these-expressions"><i class="fa fa-check"></i><b>5.6</b> Exercise: explaining these expressions?</a></li>
<li class="chapter" data-level="5.7" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-implementing-it-in-the-numerical-model"><i class="fa fa-check"></i><b>5.7</b> Exercise: implementing it in the numerical model</a></li>
<li class="chapter" data-level="5.8" data-path="hawk-dove-games-with-relatives.html"><a href="hawk-dove-games-with-relatives.html#exercise-varying-the-values-of-r"><i class="fa fa-check"></i><b>5.8</b> Exercise: varying the values of <span class="math inline">\(r\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html"><i class="fa fa-check"></i><b>6</b> Spatially explicit models of the Hawk Dove game</a>
<ul>
<li class="chapter" data-level="6.1" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-6"><i class="fa fa-check"></i><b>6.1</b> Exercise</a></li>
<li class="chapter" data-level="6.2" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#investigating-how-dispersal-affects-aggression-adding-space-to-the-hawk-dove-game"><i class="fa fa-check"></i><b>6.2</b> Investigating how dispersal affects aggression: adding space to the Hawk Dove game</a></li>
<li class="chapter" data-level="6.3" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-7"><i class="fa fa-check"></i><b>6.3</b> Exercise</a></li>
<li class="chapter" data-level="6.4" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#a-spatial-model-of-the-hawk-dove-game"><i class="fa fa-check"></i><b>6.4</b> A spatial model of the hawk dove game</a></li>
<li class="chapter" data-level="6.5" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-8"><i class="fa fa-check"></i><b>6.5</b> Exercise</a></li>
<li class="chapter" data-level="6.6" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-9"><i class="fa fa-check"></i><b>6.6</b> Exercise</a></li>
<li class="chapter" data-level="6.7" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-10"><i class="fa fa-check"></i><b>6.7</b> Exercise</a></li>
<li class="chapter" data-level="6.8" data-path="spatially-explicit-models-of-the-hawk-dove-game.html"><a href="spatially-explicit-models-of-the-hawk-dove-game.html#exercise-11"><i class="fa fa-check"></i><b>6.8</b> Exercise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Evolutionary Behavioural Ecology: practicals 1 &amp; 2 - Modelling Evolution</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hawk-dove-games-with-relatives" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Hawk Dove games with relatives<a href="hawk-dove-games-with-relatives.html#hawk-dove-games-with-relatives" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous practical, we used the Hawk Dove game to study the evolution of fighting behaviour. We found that aggression can be limited by costs of fighting, and also that it may be easier for a population of Doves to be invaded by Hawks rather than vice versa (do you remember why?).</p>
<p>In this practical, we take the Hawk Dove game a step further by considering how interactions among relatives affect the evolution of aggression. Indeed, one could argue that a Hawk could be analogous to a defector that exploits cooperative Doves.</p>
<p>In the simple model we used previously, interactions were entirely driven by <em>random</em> encounters, so that the probability of encountering one type vs the other was given by the frequencies of Hawks <span class="math inline">\(p_{t}\)</span> and Doves <span class="math inline">\(1-p_{t}\)</span> in generation <span class="math inline">\(t\)</span>.</p>
<p>Now we study the case where interactions are not random, but some assortment takes place. Hence, we need to change the model in the same way the prisoner’s dilemma model is changed to account for non-random interactions.</p>
<p>While we will use the same payoff matrix as before (see <a href="#tab:payoffHD">the table in chapter 2</a>), let us now change the interaction probabilities between the individuals. Recall the previous fitness expressions <span class="math inline">\(W_{H}\)</span> and <span class="math inline">\(W_{D}\)</span> for Hawks and Doves respectively:
<span class="math display" id="eq:wD" id="eq:wH">\[\begin{align}
W_{H} &amp;= w_{0} + p_{t} \frac{v-c}{2} + \left(1 - p_{t} \right) v \tag{5.1} \\
W_{D} &amp;= w_{0} + p_{t} (0) + \left(1 - p_{t} \right) \frac{v}{2} \tag{5.2}\\
\end{align}\]</span></p>
<p>Below you find the R code that we used to iterate the system of equations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="hawk-dove-games-with-relatives.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># broken code on the evolution of hawks vs doves</span></span>
<span id="cb1-2"><a href="hawk-dove-games-with-relatives.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we intend to iterate the haploid population genetics</span></span>
<span id="cb1-3"><a href="hawk-dove-games-with-relatives.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># recursion p(t+1) = p(t)*...</span></span>
<span id="cb1-4"><a href="hawk-dove-games-with-relatives.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># but quite some things are missing or are wrong.</span></span>
<span id="cb1-5"><a href="hawk-dove-games-with-relatives.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Can you spot the errors / omissions?</span></span>
<span id="cb1-6"><a href="hawk-dove-games-with-relatives.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="hawk-dove-games-with-relatives.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters coding the payoffs</span></span>
<span id="cb1-8"><a href="hawk-dove-games-with-relatives.html#cb1-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fl">1.0</span></span>
<span id="cb1-9"><a href="hawk-dove-games-with-relatives.html#cb1-9" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-10"><a href="hawk-dove-games-with-relatives.html#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="hawk-dove-games-with-relatives.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># baseline fitness</span></span>
<span id="cb1-12"><a href="hawk-dove-games-with-relatives.html#cb1-12" aria-hidden="true" tabindex="-1"></a>w0 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-13"><a href="hawk-dove-games-with-relatives.html#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="hawk-dove-games-with-relatives.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># maximum time the simulation should run for</span></span>
<span id="cb1-15"><a href="hawk-dove-games-with-relatives.html#cb1-15" aria-hidden="true" tabindex="-1"></a>max_time <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb1-16"><a href="hawk-dove-games-with-relatives.html#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="hawk-dove-games-with-relatives.html#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># a vector containing allele frequencies</span></span>
<span id="cb1-18"><a href="hawk-dove-games-with-relatives.html#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># for all time steps</span></span>
<span id="cb1-19"><a href="hawk-dove-games-with-relatives.html#cb1-19" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span><span class="cn">NA</span>, <span class="at">times=</span>max_time)</span>
<span id="cb1-20"><a href="hawk-dove-games-with-relatives.html#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="hawk-dove-games-with-relatives.html#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># set the initial frequency of the hawks</span></span>
<span id="cb1-22"><a href="hawk-dove-games-with-relatives.html#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># at time step 1</span></span>
<span id="cb1-23"><a href="hawk-dove-games-with-relatives.html#cb1-23" aria-hidden="true" tabindex="-1"></a>p[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb1-24"><a href="hawk-dove-games-with-relatives.html#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="hawk-dove-games-with-relatives.html#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># a for loop to iterate the recursion equation</span></span>
<span id="cb1-26"><a href="hawk-dove-games-with-relatives.html#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># over multiple timesteps</span></span>
<span id="cb1-27"><a href="hawk-dove-games-with-relatives.html#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (time_idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(max_time<span class="dv">-1</span>))</span>
<span id="cb1-28"><a href="hawk-dove-games-with-relatives.html#cb1-28" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-29"><a href="hawk-dove-games-with-relatives.html#cb1-29" aria-hidden="true" tabindex="-1"></a>  wH <span class="ot">&lt;-</span> w0 <span class="sc">+</span> p[[time_idx]] <span class="sc">*</span> (v<span class="sc">-</span>c)<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p[[time_idx]]) <span class="sc">*</span> v</span>
<span id="cb1-30"><a href="hawk-dove-games-with-relatives.html#cb1-30" aria-hidden="true" tabindex="-1"></a>  wD <span class="ot">&lt;-</span> w0 <span class="sc">+</span> p[[time_idx]] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>p[[time_idx]]) <span class="sc">*</span> v<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb1-31"><a href="hawk-dove-games-with-relatives.html#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="hawk-dove-games-with-relatives.html#cb1-32" aria-hidden="true" tabindex="-1"></a>  wBar <span class="ot">&lt;-</span> wH <span class="sc">*</span> p[[time_idx]] <span class="sc">+</span> wD <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>p[[time_idx]])</span>
<span id="cb1-33"><a href="hawk-dove-games-with-relatives.html#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="hawk-dove-games-with-relatives.html#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># recursion equation</span></span>
<span id="cb1-35"><a href="hawk-dove-games-with-relatives.html#cb1-35" aria-hidden="true" tabindex="-1"></a>  p[[time_idx <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> p[[time_idx]] <span class="sc">*</span> wH <span class="sc">/</span> wBar</span>
<span id="cb1-36"><a href="hawk-dove-games-with-relatives.html#cb1-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="exercise-running-the-model" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Exercise: running the model<a href="hawk-dove-games-with-relatives.html#exercise-running-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just to get yourself familiar with the model again, try to run it for different values of <span class="math inline">\(v\)</span> and <span class="math inline">\(c\)</span> and see what happens.</p>
</div>
<div id="interactions-among-relatives" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Interactions among relatives<a href="hawk-dove-games-with-relatives.html#interactions-among-relatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rather than using the frequencies <span class="math inline">\(p_{t}\)</span> and <span class="math inline">\(1-p_{t}\)</span>, we will now modify the Hawk Dove game by using <em>conditional probabilities</em> reflecting non-random encounter rates, replacing the random encounter rates.</p>
<ul>
<li><span class="math display">\[ \Pr(H \mid H)\]</span> probability of encounter between a focal Hawk and non-focal Hawk.</li>
<li><span class="math display">\[ \Pr(D \mid H)\]</span> probability of encounter between a focal Hawk and a Dove (note again, that <span class="math inline">\(\Pr(H \mid H) + Pr(D \mid H) = 1\)</span>).</li>
<li><span class="math display">\[ \Pr(H \mid D)\]</span> probability of encounter between a focal Dove and a Hawk.</li>
<li><span class="math display">\[ \Pr(D \mid D)\]</span> probability of encounter between a focal Dove and a non-focal Dove (<span class="math inline">\(\Pr(H \mid D) + \Pr(D \mid D) = 1\)</span>).</li>
</ul>
<p>Incorporating these conditional probabilities into the fitness expressions above yields
<span class="math display" id="eq:wD" id="eq:wH">\[\begin{align}
W_{H} &amp;= w_{0} + \Pr(H\mid H) \frac{v-c}{2} +  \Pr (D \mid H ) v \tag{5.1} \\
W_{D} &amp;= w_{0} + \Pr (H \mid D) (0) + \Pr ( D \mid D )  \frac{v}{2} \tag{5.2}\\
\end{align}\]</span></p>
</div>
<div id="hamiltons-rule-in-a-hawk-dove-game" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Hamilton’s rule in a Hawk Dove game?<a href="hawk-dove-games-with-relatives.html#hamiltons-rule-in-a-hawk-dove-game" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we would follow the example of the Prisoner’s dilemma in the lecture slides, would we expect to find something similar to Hamilton’s rule when we assess the condition in which more cooperative Doves do better than defecting Hawks, i.e., <span class="math inline">\(W_{D} &gt; W_{H}\)</span>?</p>
<p>Let us look again at the Prisoner’s dilemma: altruists (<span class="math inline">\(A\)</span>) do better than nonaltruists <span class="math inline">\(NA\)</span> (originally called ‘Defect’ in the lecture slides but I change notation to avoid confusion with Dove) when <span class="math inline">\(W_{A} &gt; W_{NA}\)</span>, which eventually results in (see lecture slides):
<span class="math display">\[\begin{align}
\left( \Pr(A \mid A ) - \Pr(A \mid NA ) \right ) b &amp;&gt; c \\
\end{align}\]</span>
where the term <span class="math inline">\(\Pr(A \mid A ) - \Pr(A \mid NA )\)</span> can be shown to reflect the coefficient of relatedness <span class="math inline">\(r\)</span>.</p>
<p>In case Hamilton’s rule would apply to the Hawk Dove game, we would thus expect an expression of the form
<span class="math display">\[\begin{align}
\left(\Pr(D \mid D) - \Pr(D \mid H ) \right ) x &amp;&gt; y \\
\end{align}\]</span>
where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> would be coefficients that would result from combinations of payoffs in the Hawk Dove game.</p>
<p>Yet, actually working out the same tricks on the Hawk Dove game as was done on the Prisoner’s Dilemma in the preceding lecture, we obtain something rather different, namely
<span class="math display">\[\begin{align}
\left [ \Pr (D \mid D) - \Pr ( D \mid H) \right ] v - \Pr (D \mid H) v &gt; \Pr ( H \mid H ) \left (v - c \right )
\end{align}\]</span></p>
<p>Clearly, coefficients are not simply <span class="math inline">\(v\)</span> on the left hand side and <span class="math inline">\(c\)</span> on the right, but that is obvious as costs are not carried by the cooperators, but rather by pairs of interacting Hawks. But beyond this, there is something more important to note in the expression above, namely that next to the relatedness coefficient <span class="math inline">\(\Pr(D \mid D) - \Pr(D \mid H )\)</span> there is an additional coefficient on the left-hand side (and the right-hand side is multiplied by <span class="math inline">\(\Pr(H\mid H)\)</span>).</p>
<p>Hence, rather than anything like <span class="math inline">\(r x &gt; y\)</span> we now have <span class="math inline">\(r x + k z &gt; g y\)</span> (i.e., lots more terms)!! And that despite it being a super simple 2 player game! What is going on??</p>
</div>
<div id="exercise-the-downfall-of-hamiltons-rule" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercise: the downfall of Hamilton’s rule<a href="hawk-dove-games-with-relatives.html#exercise-the-downfall-of-hamiltons-rule" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Can you think of why a simple expression like <span class="math inline">\(r x &gt; y\)</span> does not apply to the Hawk Dove game? Specifically, compare the payoff matrix for the Prisoner’s dilemma (see lecture slides) with the one of the Hawk dove game (see <a href="#tab:payoffHD">the table in chapter 2</a>). What happens if you move from the top row to the bottom row in the payoff matrix, does the payoff increase / decrease by the same amount in the Hawk Dove game vs the Prisoner’s Dilemma? What happens if you move from the left column to the right column? Discuss.</p>
</div>
<div id="evolution-of-aggression-when-relatives-interact-in-r" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Evolution of aggression when relatives interact in R<a href="hawk-dove-games-with-relatives.html#evolution-of-aggression-when-relatives-interact-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we know we cannot really use Hamilton’s rule to predict when Doves will outlive Hawks, we have to resort to our previously used method of iterating a population genetics recursion equation in R to predict how interactions among relatives affects aggression. It turns out, relatedness <span class="math inline">\(r\)</span> comes into this in another way, namely directly through the conditional probabilities. If we interpret <span class="math inline">\(r\)</span> as being the chance of interacting with an individual that shares an allele identical by descent, we have</p>
<ul>
<li><span class="math display">\[ \Pr(H \mid H) = r \times 1 + (1-r ) p_{t} \]</span> probability of encounter between a focal Hawk and non-focal Hawk.</li>
<li><span class="math display">\[ \Pr(D \mid H) = r \times 0 + (1-r) (1-p_{t}) \]</span> probability of encounter between a focal Hawk and a Dove (note that <span class="math inline">\(\Pr(H \mid H) + Pr(D \mid H) = 1\)</span>).</li>
<li><span class="math display">\[ \Pr(H \mid D) = r \times 0 + (1-r) p_{t} \]</span> probability of encounter between a focal Dove and a Hawk</li>
<li><span class="math display">\[ \Pr(D \mid D) = r \times 1 + (1- r) (1-p_{t} ) \]</span> probability of encounter between a focal Dove and a non-focal Dove (<span class="math inline">\(\Pr(H \mid D) + \Pr(D \mid D) = 1\)</span>).</li>
</ul>
</div>
<div id="exercise-explaining-these-expressions" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Exercise: explaining these expressions?<a href="hawk-dove-games-with-relatives.html#exercise-explaining-these-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Can you try to explain what is going on in the expressions above? Why do allele frequencies <span class="math inline">\(p_{t}\)</span> still feature here?</p>
</div>
<div id="exercise-implementing-it-in-the-numerical-model" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Exercise: implementing it in the numerical model<a href="hawk-dove-games-with-relatives.html#exercise-implementing-it-in-the-numerical-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Copy-paste the code of the correct numerical iterations of the hawk dove game above and modify the encounter rates to allow for nonrandom interactions. While <span class="math inline">\(p_{t}\)</span> is still the allele frequency of the Hawk allele, you have to add <span class="math inline">\(r\)</span> as a constant parameter, which you can give any value between <span class="math inline">\(0 \leq r \leq 1\)</span> before you start the iteration. Start with <span class="math inline">\(r=0.5\)</span>, for example, what does this mean about the relatives any individual is most likely to interact?</p></li>
<li><p>Is it reasonable to think as <span class="math inline">\(r\)</span> as a constant parameter?</p></li>
</ol>
</div>
<div id="exercise-varying-the-values-of-r" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Exercise: varying the values of <span class="math inline">\(r\)</span><a href="hawk-dove-games-with-relatives.html#exercise-varying-the-values-of-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plot your results for different values of <span class="math inline">\(r\)</span>, either in Excel or by using one of the plotting packages in R. Is the relationship between aggression and <span class="math inline">\(r\)</span> in line with your expectations?</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="individual-based-simulations-and-drift.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatially-explicit-models-of-the-hawk-dove-game.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bramkuijper/04-hawk-dove-relatives.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
