<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Maximum Likelihood and age-dependent seropositivity | Epidemiological Modelling: Course Notes</title>
  <meta name="description" content="Course notes epidemiology" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Maximum Likelihood and age-dependent seropositivity | Epidemiological Modelling: Course Notes" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes epidemiology" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Maximum Likelihood and age-dependent seropositivity | Epidemiological Modelling: Course Notes" />
  
  <meta name="twitter:description" content="Course notes epidemiology" />
  

<meta name="author" content="Bram Kuijper, Mario Recker" />


<meta name="date" content="2024-02-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial-uncertainties.html"/>
<link rel="next" href="parts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Course notes epidemiological modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lecture notes for lectures 7-10</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#copying-code"><i class="fa fa-check"></i><b>1.1</b> Copying code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tutorial-uncertainties.html"><a href="tutorial-uncertainties.html"><i class="fa fa-check"></i><b>2</b> Tutorial uncertainties</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tutorial-uncertainties.html"><a href="tutorial-uncertainties.html#estimating-r_0-in-a-risk-heterogenous-population"><i class="fa fa-check"></i><b>2.1</b> Estimating <span class="math inline">\(R_{0}\)</span> in a risk-heterogenous population</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="tutorial-uncertainties.html"><a href="tutorial-uncertainties.html#sis-model-code"><i class="fa fa-check"></i><b>2.1.1</b> SIS model code</a></li>
<li class="chapter" data-level="2.1.2" data-path="tutorial-uncertainties.html"><a href="tutorial-uncertainties.html#task-estimate-r0-without-taking-into-account-risk"><i class="fa fa-check"></i><b>2.1.2</b> Task: estimate R0 without taking into account risk</a></li>
<li class="chapter" data-level="2.1.3" data-path="tutorial-uncertainties.html"><a href="tutorial-uncertainties.html#task-estimate-r0-while-taking-into-account-risk"><i class="fa fa-check"></i><b>2.1.3</b> Task: estimate R0 while taking into account risk</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html"><i class="fa fa-check"></i><b>3</b> Maximum Likelihood and age-dependent seropositivity</a>
<ul>
<li class="chapter" data-level="3.1" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#the-datasets"><i class="fa fa-check"></i><b>3.1</b> The datasets</a></li>
<li class="chapter" data-level="3.2" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-1-quite-some-susceptibles-in-early-life"><i class="fa fa-check"></i><b>3.2</b> Dataset 1: quite some susceptibles in early life</a></li>
<li class="chapter" data-level="3.3" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-2-few-susceptibles-in-early-life"><i class="fa fa-check"></i><b>3.3</b> Dataset 2: few susceptibles in early life</a></li>
<li class="chapter" data-level="3.4" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-3-loss-of-immunity-in-later-life"><i class="fa fa-check"></i><b>3.4</b> Dataset 3: loss of immunity in later life</a></li>
<li class="chapter" data-level="3.5" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#probabilities-and-the-likelihood-function"><i class="fa fa-check"></i><b>3.5</b> Probabilities and the likelihood function</a></li>
<li class="chapter" data-level="3.6" data-path="maximum-likelihood-and-age-dependent-seropositivity.html"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#task-calculating-the-log-likelihood-for-r_0-3"><i class="fa fa-check"></i><b>3.6</b> Task: calculating the log-likelihood for <span class="math inline">\(R_{0} = 3\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>4</b> Parts</a></li>
<li class="chapter" data-level="5" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html"><i class="fa fa-check"></i><b>5</b> Fitting dynamic models to data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#hong-kong-flu-dataset"><i class="fa fa-check"></i><b>5.1</b> Hong Kong flu dataset</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#setting-up-the-sir-model"><i class="fa fa-check"></i><b>5.1.1</b> Setting up the SIR model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#task-finalize-the-sir_ode-code-above"><i class="fa fa-check"></i><b>5.2</b> Task: finalize the <code>sir_ode</code> code above</a></li>
<li class="chapter" data-level="5.3" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#interfacing-the-model-with-the-data"><i class="fa fa-check"></i><b>5.3</b> Interfacing the model with the data</a></li>
<li class="chapter" data-level="5.4" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#task-try-to-finish-the-function-code-above"><i class="fa fa-check"></i><b>5.4</b> Task: try to finish the function code above</a></li>
<li class="chapter" data-level="5.5" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#task-test-driving-our-function"><i class="fa fa-check"></i><b>5.5</b> Task: test driving our function</a></li>
<li class="chapter" data-level="5.6" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#task"><i class="fa fa-check"></i><b>5.6</b> Task:</a></li>
<li class="chapter" data-level="5.7" data-path="fitting-dynamic-models-to-data.html"><a href="fitting-dynamic-models-to-data.html#task-missing-data"><i class="fa fa-check"></i><b>5.7</b> Task: missing data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>6</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>6.1</b> Footnotes</a></li>
<li class="chapter" data-level="6.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>6.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>7</b> Blocks</a>
<ul>
<li class="chapter" data-level="7.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>7.1</b> Equations</a></li>
<li class="chapter" data-level="7.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>7.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="7.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>7.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>8</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>8.1</b> Publishing</a></li>
<li class="chapter" data-level="8.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>8.2</b> 404 pages</a></li>
<li class="chapter" data-level="8.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>8.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epidemiological Modelling: Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maximum-likelihood-and-age-dependent-seropositivity" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Maximum Likelihood and age-dependent seropositivity<a href="maximum-likelihood-and-age-dependent-seropositivity.html#maximum-likelihood-and-age-dependent-seropositivity" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For a disease with an unknown <span class="math inline">\(R_{0}\)</span>, we provide
three datasets with data on whether individuals are seropositive or seronegative (i.e.,have antibodies or not) and that individual’s age. These datasets are similar to the three datasets shown during tutorial 7 on uncertainty.</p>
<p>We will use this dataset to produce a maximum likelihood
approach to estimate the value of <span class="math inline">\(R_{0}\)</span> for each of these datasets.</p>
<div id="the-datasets" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> The datasets<a href="maximum-likelihood-and-age-dependent-seropositivity.html#the-datasets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can download the datasets below by clicking on the <em>csv</em> button at the top of the table, save them to disk and then read them into R with the command <code>read.table()</code>. Make sure to choose a sensible file name.</p>
</div>
<div id="dataset-1-quite-some-susceptibles-in-early-life" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Dataset 1: quite some susceptibles in early life<a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-1-quite-some-susceptibles-in-early-life" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a97b54201c959e2193e0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a97b54201c959e2193e0">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],[43,28,10,79,57,38,36,70,44,25,49,30,8,48,12,48,45,65,69,56,14,11,28,48,86,69,72,68,7,25,8,5,53,35,22,14,22,53,59,62,29,61,67,52,41,17,29,15,39,25,28,40,14,19,46,44,68,73,18,47,63,44,39,50,24,57,47,19,15,3,30,88,35,28,35,24,50,55,6,65,20,63,76,46,31,28,48,29,24,80,68,23,70,34,2,70,6,58,18,19,14,88,80,32,10,15,90,19,40,61,18,27,34,30,70,63,20,65,38,34,25,24,2,48,15,32,72,9,29,44,20,87,22,87,56,23,31,20,39,29,40,44,39,7,89,38,85,68,70,5,34,2,87,59,4,49,67,80,75,79,86,82,76,45,68,60,60,65,24,49,12,35,75,16,32,6,66,32,3,9,46,77,20,48,19,78,34,67,42,73,45,29,46,85,16,2,51,56,9,13,25,18,1,38,70,7,22,56,30,38,15,49,34,3,26,84,71,61,5,68,24,9,15,60,58,25,9,80,44,8,24,36,66,25,88,33,42,53,51,20,56,87,28,14,42,87,22,53,89,13,11,73,45,40,26,57,15,5,8,36,48,36,37,56,87,34,5,88,87,25,45,62,28,46,75,44,68,69,76,40,40,53,1,87,89,37,46,44,34,70,57,22,8,51,83,32,13,5,50,38],[0,1,0,1,1,1,0,0,1,0,1,1,0,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,0,1,0,0,1,1,1,0,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,1,0,1,0,1,1,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,0,1,1,0,1,1,1,1,0,1,1,0,0,1,1,1,0,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,0,0,1,0,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,0,1,1,0,0,1,1,1,0,1,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,0,1,1,0,1,1,1,0,1,0,1,1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>sero<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Blfrtip","buttons":["csv"],"lengthMenu":[[5,25,50,-1],["10","25","50","All"]],"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"sero","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dataset-2-few-susceptibles-in-early-life" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Dataset 2: few susceptibles in early life<a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-2-few-susceptibles-in-early-life" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="datatables html-widget html-fill-item" id="htmlwidget-16382f1a0151575af153" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-16382f1a0151575af153">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],[56,59,36,39,26,16,11,61,85,56,88,86,15,83,87,63,79,57,6,74,38,26,75,40,63,27,88,86,4,19,13,65,61,52,18,76,77,60,56,5,52,2,84,11,2,62,27,82,25,69,10,32,64,42,67,45,7,30,67,44,32,34,3,75,8,74,72,72,31,84,51,75,39,3,56,40,48,17,53,17,63,1,47,58,28,41,87,63,36,63,4,65,38,2,34,86,9,53,55,82,82,54,16,62,85,38,53,24,45,66,61,59,17,55,40,75,59,51,47,14,22,11,78,37,35,60,76,59,83,32,78,60,6,79,51,9,5,2,42,27,28,77,21,85,50,41,84,39,55,60,89,22,89,2,45,54,75,68,48,25,36,69,79,37,46,48,15,81,18,80,49,77,71,38,39,79,12,1,14,1,30,80,47,64,6,46,55,2,55,90,56,68,70,58,76,18,60,46,54,6,14,57,56,65,79,17,39,12,4,46,55,71,22,81,30,62,26,2,26,50,61,78,46,17,78,30,34,47,2,90,60,57,55,46,64,66,13,86,51,23,86,16,44,19,37,78,30,42,61,61,10,63,58,14,21,50,3,30,82,2,60,2,28,49,59,15,22,25,66,58,6,25,66,69,41,6,1,80,47,15,28,79,64,36,51,57,5,54,32,56,58,9,85,12,82,53,49,43,8,34],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>sero<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Blfrtip","buttons":["csv"],"lengthMenu":[[5,25,50,-1],["10","25","50","All"]],"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"sero","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="dataset-3-loss-of-immunity-in-later-life" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Dataset 3: loss of immunity in later life<a href="maximum-likelihood-and-age-dependent-seropositivity.html#dataset-3-loss-of-immunity-in-later-life" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="datatables html-widget html-fill-item" id="htmlwidget-e746e5f19c558eabfe96" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e746e5f19c558eabfe96">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300"],[5,71,67,20,74,19,60,88,38,88,15,36,70,15,52,20,19,16,68,19,36,15,22,61,31,86,36,68,75,70,45,18,18,26,25,75,37,46,63,63,38,7,54,72,53,65,76,77,84,82,42,15,60,32,11,12,81,8,52,21,8,12,53,14,32,37,11,17,35,36,71,60,76,30,42,64,41,56,72,8,70,10,39,64,48,27,28,7,45,1,70,16,89,42,32,13,12,15,6,48,30,47,83,20,70,4,70,3,56,24,88,84,56,89,22,73,1,19,50,88,83,90,28,62,30,22,84,23,88,23,56,55,47,31,15,13,6,61,68,58,64,59,30,69,39,46,33,48,18,53,50,42,20,62,36,48,29,48,25,79,70,61,67,60,46,55,28,5,44,64,32,90,58,51,88,45,11,78,1,10,5,16,62,49,90,13,40,68,69,87,90,13,85,50,20,13,62,52,14,63,82,8,11,56,5,7,13,18,56,54,8,23,88,80,43,63,90,28,89,87,81,86,21,71,53,30,22,9,69,34,88,79,7,22,58,89,19,36,38,11,16,37,27,56,41,45,72,79,3,63,49,15,13,25,24,85,34,25,14,1,10,15,53,76,73,44,47,36,29,79,14,30,89,30,78,82,85,50,65,72,29,49,86,42,76,71,85,58,36,54,38,7,76,62,43,44,62,1,43,43],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,0,0,1,0,1,0,0,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,1,1,0,0,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,1,0,1,1,1,0,0,1,0,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,1,0,1,0,0,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,1,0,0,1,0,1,0,1,1,1,1,1,1,0,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>age<\/th>\n      <th>sero<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Blfrtip","buttons":["csv"],"lengthMenu":[[5,25,50,-1],["10","25","50","All"]],"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"age","targets":1},{"name":"sero","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="probabilities-and-the-likelihood-function" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Probabilities and the likelihood function<a href="maximum-likelihood-and-age-dependent-seropositivity.html#probabilities-and-the-likelihood-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let <span class="math inline">\(P(a_{i}) = \exp \left [-a_{i}\mu \left (R_{0} - 1 \right ) \right ]\)</span> be the probability that the <span class="math inline">\(i\)</span>th individual sampled of age <span class="math inline">\(a_{i}\)</span> is still susceptible (i.e., has no antibodies). Similarly, <span class="math inline">\(Q(a_{i}) = 1 - \exp \left [-a_{i}\mu \left (R_{0} - 1 \right ) \right ]\)</span> reflects the probability that someone is <em>not</em> susceptible.</p>
<p>We will now use these probabilities
to calculate the log-likelihood, using the following function:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-1" tabindex="-1"></a><span class="co"># function that calculates a likelihood</span></span>
<span id="cb2-2"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-2" tabindex="-1"></a><span class="co"># for: </span></span>
<span id="cb2-3"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-3" tabindex="-1"></a><span class="co"># - an R0 that you provide</span></span>
<span id="cb2-4"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-4" tabindex="-1"></a><span class="co"># - a data.frame data </span></span>
<span id="cb2-5"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-5" tabindex="-1"></a><span class="co">#       with columns &#39;age&#39; and &#39;sero&#39;</span></span>
<span id="cb2-6"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-6" tabindex="-1"></a><span class="co">#       reflecting ages of individuals and whether</span></span>
<span id="cb2-7"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-7" tabindex="-1"></a><span class="co">#       they are seropositive</span></span>
<span id="cb2-8"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-8" tabindex="-1"></a><span class="co"># - mu, the mortality rate</span></span>
<span id="cb2-9"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-9" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="cf">function</span>(R0, data, mu)</span>
<span id="cb2-10"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-10" tabindex="-1"></a>{</span>
<span id="cb2-11"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-11" tabindex="-1"></a>    <span class="co"># initialize the log likelihood</span></span>
<span id="cb2-12"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-12" tabindex="-1"></a>    <span class="co"># by setting it to zero, we will</span></span>
<span id="cb2-13"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-13" tabindex="-1"></a>    <span class="co"># add to this value below</span></span>
<span id="cb2-14"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-14" tabindex="-1"></a>    loglik <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-15"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-15" tabindex="-1"></a>    </span>
<span id="cb2-16"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-16" tabindex="-1"></a>    <span class="co"># go through all the individual values</span></span>
<span id="cb2-17"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-17" tabindex="-1"></a>    <span class="co"># by going through all the rows in the dataset</span></span>
<span id="cb2-18"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-18" tabindex="-1"></a>    <span class="cf">for</span> (row_idx <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data))</span>
<span id="cb2-19"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-19" tabindex="-1"></a>    {</span>
<span id="cb2-20"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-20" tabindex="-1"></a>        <span class="co"># get the age</span></span>
<span id="cb2-21"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-21" tabindex="-1"></a>        age <span class="ot">&lt;-</span> data[row_idx,<span class="st">&quot;age&quot;</span>]</span>
<span id="cb2-22"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-22" tabindex="-1"></a>        </span>
<span id="cb2-23"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-23" tabindex="-1"></a>        <span class="co">#  individual sero positive</span></span>
<span id="cb2-24"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-24" tabindex="-1"></a>        <span class="cf">if</span> (data[row_idx,<span class="st">&quot;sero&quot;</span>] <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb2-25"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-25" tabindex="-1"></a>        {</span>
<span id="cb2-26"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-26" tabindex="-1"></a>            loglik <span class="ot">&lt;-</span> loglik <span class="sc">+</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>age <span class="sc">*</span> mu  <span class="sc">*</span> (R0 <span class="sc">-</span> <span class="dv">1</span>)))</span>
<span id="cb2-27"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-27" tabindex="-1"></a>        } <span class="cf">else</span> <span class="co"># individual sero negative</span></span>
<span id="cb2-28"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-28" tabindex="-1"></a>        {</span>
<span id="cb2-29"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-29" tabindex="-1"></a>            <span class="co"># log(exp(-age * mu *(R0 - 1)))</span></span>
<span id="cb2-30"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-30" tabindex="-1"></a>            <span class="co"># = -age * mu * (R0 - 1)</span></span>
<span id="cb2-31"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-31" tabindex="-1"></a>            loglik <span class="ot">&lt;-</span> loglik <span class="sc">-</span> age <span class="sc">*</span> mu <span class="sc">*</span> (R0 <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb2-32"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-32" tabindex="-1"></a>        }</span>
<span id="cb2-33"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-33" tabindex="-1"></a>    } <span class="co"># end for loop</span></span>
<span id="cb2-34"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-34" tabindex="-1"></a>    </span>
<span id="cb2-35"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-35" tabindex="-1"></a>    <span class="fu">return</span>(loglik)</span>
<span id="cb2-36"><a href="maximum-likelihood-and-age-dependent-seropositivity.html#cb2-36" tabindex="-1"></a>} <span class="co"># end ll()</span></span></code></pre></div>
</div>
<div id="task-calculating-the-log-likelihood-for-r_0-3" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Task: calculating the log-likelihood for <span class="math inline">\(R_{0} = 3\)</span><a href="maximum-likelihood-and-age-dependent-seropositivity.html#task-calculating-the-log-likelihood-for-r_0-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now use the function above by giving it <span class="math inline">\(R_{0} = 3\)</span>, <span class="math inline">\(\mu = 1/80\)</span> and the first dataset that you can download above.
The value that you should get out of this should be:</p>
<pre><code>## [1] -151.4656</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial-uncertainties.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="parts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-tutorial_uncertainties.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
